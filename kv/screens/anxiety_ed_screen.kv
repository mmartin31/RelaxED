# Kivy file for the anxiety education screen.
# Provides links to educational resources and an educational powerpoint presentation.

# Import for handling external links
#:import webbrowser webbrowser

<AnxietyEDScreen>:
    name: "Anxiety Education"  # screen name for navigation
    CommonBackground:  # applies the common background

    # Main scroll view container
    ScrollView:
        # only allow vertical scrolling
        do_scroll_x: False
        do_scroll_y: True

        # Main content container
        BoxLayout:
            orientation: 'vertical'
            padding: "20dp"  # padding around content
            spacing: "10dp"  # space between sections
            size_hint_y: None  # required for scrolling
            height: self.minimum_height  # adjust height to content

            # Header Section
            Label:
                text: "Anxiety Management Resources"
                color: 0, 0, 0, 1  # black text
                font_size: '32sp'
                size_hint_y: None
                height: self.texture_size[1]  # adjust height to text
                text_size: self.width, None
                halign: 'center'
                valign: 'middle'
                bold: True

            # Binaural Beats Section
            BoxLayout:
                orientation: 'vertical'
                padding: "10dp"
                spacing: "5dp"
                size_hint_y: None
                height: "90dp"

                # Section Title
                Label:
                    text: "Binaural Beats"
                    color: 0, 0, 0, 1  # black
                    font_size: '24sp'
                    bold: True
                    size_hint_y: None
                    height: self.texture_size[1]
                    text_size: self.width, None
                    halign: 'center'
                    valign: 'middle'

                # Clickable YouTube links
                Label:
                    text: "[ref=link1][u]Calming Binaural Beats[/u][/ref]"
                    markup: True  # enable markup for underlining
                    color: 0, 0, 0.55, 1  # blue
                    font_size: '16sp'
                    size_hint_y: None
                    height: self.texture_size[1]
                    # open link in web browser
                    on_ref_press: webbrowser.open("https://www.youtube.com/watch?v=xsfyb1pStdw")

                Label:
                    text: "[ref=link2][u]Anxiety Relief Beats[/u][/ref]"
                    markup: True
                    color: 0, 0, 0.55, 1
                    font_size: '16sp'
                    size_hint_y: None
                    height: self.texture_size[1]
                    on_ref_press: webbrowser.open("https://www.youtube.com/watch?v=JP3R00tCL4I")

            # Mindfulness/Meditation Section
            BoxLayout:
                orientation: 'vertical'
                padding: "10dp"
                spacing: "5dp"
                size_hint_y: None
                height: "120dp"

                # Section Title
                Label:
                    text: "Mindfulness/ Meditation"
                    color: 0, 0, 0, 1
                    font_size: '24sp'
                    bold: True
                    size_hint_y: None
                    height: self.texture_size[1]
                    text_size: self.width, None
                    halign: 'center'
                    valign: 'middle'

                # Resource links
                Label:
                    text: "[ref=link3][u]Guided Meditation[/u][/ref]"
                    markup: True
                    color: 0, 0, 0.55, 1
                    font_size: '16sp'
                    size_hint_y: None
                    height: self.texture_size[1]
                    on_ref_press: webbrowser.open("https://www.youtube.com/watch?v=ZToicYcHIOU")

                Label:
                    text: "[ref=link4][u]Mindfulness Exercise[/u][/ref]"
                    markup: True
                    color: 0, 0, 0.55, 1
                    font_size: '16sp'
                    size_hint_y: None
                    height: self.texture_size[1]
                    on_ref_press: webbrowser.open("https://www.youtube.com/watch?v=Xl_B45DpMLU")

            # PowerPoint Section with Controls
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None
                spacing: "10dp"
                height: "400dp"

                # Presentation title
                Label:
                    text: "Understanding Anxiety - Educational Slides"
                    color: 0, 0, 0, 1
                    font_size: '24sp'
                    bold: True
                    size_hint_y: None
                    height: self.texture_size[1]
                    text_size: self.width, None
                    halign: 'center'
                    valign: 'middle'

                # Slide Counter
                Label:
                    size_hint_y: 0.1
                    text: f"Slide {carousel.index + 1}/19" # slide number
                    color: 0, 0, 0, 1
                    font_size: '18sp'
                    bold: True

                # Carousel
                Carousel:
                    id: carousel
                    direction: 'right'  # slide direction
                    size_hint_y: 0.6
                    height: "350dp"
                    # Slide images
                    AsyncImage:
                        source: 'pptImages/slide-1.png'
                    AsyncImage:
                        source: 'pptImages/slide-2.png'
                    AsyncImage:
                        source: 'pptImages/slide-3.png'
                    AsyncImage:
                        source: 'pptImages/slide-4.png'
                    AsyncImage:
                        source: 'pptImages/slide-5.png'
                    AsyncImage:
                        source: 'pptImages/slide-6.png'
                    AsyncImage:
                        source: 'pptImages/slide-7.png'
                    AsyncImage:
                        source: 'pptImages/slide-8.png'
                    AsyncImage:
                        source: 'pptImages/slide-9.png'
                    AsyncImage:
                        source: 'pptImages/slide-10.png'
                    AsyncImage:
                        source: 'pptImages/slide-11.png'
                    AsyncImage:
                        source: 'pptImages/slide-12.png'
                    AsyncImage:
                        source: 'pptImages/slide-13.png'
                    AsyncImage:
                        source: 'pptImages/slide-14.png'
                    AsyncImage:
                        source: 'pptImages/slide-15.png'
                    AsyncImage:
                        source: 'pptImages/slide-16.png'
                    AsyncImage:
                        source: 'pptImages/slide-17.png'
                    AsyncImage:
                        source: 'pptImages/slide-18.png'
                    AsyncImage:
                        source: 'pptImages/slide-19.png'

                # Navigation Buttons
                BoxLayout:
                    size_hint_y: None
                    height: "80sp"
                    spacing: "20dp"
                    padding: ["10dp", "50dp"]

                    # Left spacer
                    Widget:
                        size_hint_x: 0.4

                    # Previous slide button
                    Button:
                        text: "<<"
                        size_hint_x: 0.1
                        on_press: carousel.load_previous()
                        disabled: carousel.index == 0  # disable at first slide
                        opacity: 0.5 if self.disabled else 1

                    # Next slide button
                    Button:
                        text: ">>"
                        size_hint_x: 0.1
                        on_press: carousel.load_next()
                        disabled: carousel.index == 18  # disable at last slide
                        opacity: 0.5 if self.disabled else 1

                    # Right spacer
                    Widget:
                        size_hint_x: 0.4

    # Navigation Bar
    NavigationBar:
        size_hint_y: 0.1